<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QuantQuest | Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Press Start 2P', monospace; background:#1a1925; color:#fff; min-height:100vh; display:grid; place-items:center; }
    .card { width:100%; max-width:420px; background:#2c2b3c; border:2px solid #00ff99; border-radius:14px; box-shadow:0 0 14px rgba(0,255,153,.25); padding:2rem; text-align:center; }
    .btn  { width:100%; display:inline-flex; align-items:center; justify-content:center; gap:.6rem; padding:.9rem 1rem; border-radius:10px; background:#3b82f6; color:#fff; transition: transform .15s ease, filter .15s ease; }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.05); }
    .hint { color:#b8bdcf; font-size:.75rem; margin-top:.75rem; }
  </style>
</head>
<body>
  <div class="card">
    <h1 class="text-xl mb-4">üîê Sign in to QuantQuest</h1>
    <p class="text-sm opacity-80 mb-6">Save your XP, levels, streak & progress.</p>

    <button id="googleSignIn" class="btn">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" class="w-5 h-5" />
      <span>Sign in with Google</span>
    </button>

    <div class="hint">Popup opens once. After choosing your account you‚Äôll land on your Account screen.</div>
  </div>

  <!-- env.js MUS√ç b√Ωt p≈ôed firebase-init.js -->
  <script src="env.js"></script>

  <script type="module">
    import { auth, startGoogleSignIn } from './firebase-init.js';
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

    // Pokud u≈æ je p≈ôihl√°≈°en (cache), p≈ôesmƒõruj bez klik√°n√≠
    onAuthStateChanged(auth, (user) => {
      if (user) {
        console.log("üü¢ onAuthStateChanged ‚Üí user present on login.html:", user.uid);
        setTimeout(() => (window.location.href = "account.html"), 10);
      } else {
        console.log("‚ÑπÔ∏è onAuthStateChanged ‚Üí no user yet (login page)");
      }
    });

    // Volat p≈ô√≠mo z click handleru (jinak m≈Ø≈æe popup blokovat prohl√≠≈æeƒç)
    document.getElementById('googleSignIn').addEventListener('click', () => {
      startGoogleSignIn();
    });
  </script>
</body>
</html>
